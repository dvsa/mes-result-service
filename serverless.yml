service: mes-result-service

provider:
  name: aws
  runtime: nodejs16.x

functions:
  postResult:
    handler: src/functions/postResult/framework/handler.handler
    events:
      - http:
          path: test-result
          method: post

  getNextUploadBatch:
    handler: src/functions/getNextUploadBatch/framework/handler.handler
    events:
      - http:
          path: test-result/upload
          method: get

  updateUploadStatus:
    handler: src/functions/updateUploadStatus/framework/handler.handler
    events:
      - http:
          path: test-result/{appRef}/upload
          method: put

  searchResults:
    handler: src/functions/searchResults/framework/handler.handler
    events:
      - http:
          path: test-result
          method: get

  getResult:
    handler: src/functions/getResult/framework/handler.handler
    events:
      - http:
          path: test-result/{appRef}/{staffNumber}
          method: get

  getRegeneratedEmails:
    handler: src/functions/getRegeneratedEmails/framework/handler.handler
    events:
      - http:
          path: regeneratedemails/{appRef}
          method: get

  retryProcessing:
    handler: src/functions/retryProcessing/framework/handler.handler
    events:
      - http:
          path: test-result/retry
          method: get

  deleteTestResult:
    handler: src/functions/deleteTestResult/framework/handler.handler
    events:
      - http:
          path: test-result/delete
          method: put

custom:
  dynamodb:
    start:
      port: 8000
      inMemory: true
      migrate: true
  webpack:
    webpackConfig: 'webpack-sls-offline.config.js'

plugins:
  - serverless-dotenv-plugin
  - serverless-webpack
  - serverless-offline
